(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/sunui-upimg/sunui-upimg-alioos"],{"0d9b":function(e,t,n){"use strict";(function(e,u){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n("a34a"));function r(e){return e&&e.__esModule?e:{default:e}}function a(e,t,n,u,i,r,a){try{var s=e[r](a),o=s.value}catch(c){return void n(c)}s.done?t(o):Promise.resolve(o).then(u,i)}function s(e){return function(){var t=this,n=arguments;return new Promise(function(u,i){var r=e.apply(t,n);function s(e){a(r,u,i,s,o,"next",e)}function o(e){a(r,u,i,s,o,"throw",e)}s(void 0)})}}var o=n("d75b"),c=n("208e");n("dd11"),n("57df");var l=n("90de"),p={data:function(){return{upload_after_list:[],upload_picture_list:[]}},name:"sunui-upimg",props:{upImgConfig:{type:Object}},methods:{chooseImage:function(e){m(this,parseInt(e),this.upImgConfig)},uploadimage:function(e){_(this,e)},deleteImg:function(e){h(e,this)},previewImg:function(e){y(e,this)},previewImgs:function(e){w(e,this)}}};t.default=p;var f=function(){var e=new Date;e.setHours(e.getHours()+o.timeout);var t=e.toISOString(),n={expiration:t,conditions:[["content-length-range",0,5242880]]},u=c.encode(JSON.stringify(n));return u},d=function(e,t){var n=e.upImgConfig.aliConfig.AccessKeySecret||o.AccessKeySecret,u=l.HMAC(l.SHA1,t,n,{asBytes:!0}),i=l.util.bytesToBase64(u);return i},g=function(){var t=s(i.default.mark(function t(n,r,a,o){var c,l,p,g,_,h,m;return i.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return c={aliyunFileKey:"".concat(r.aliConfig.oosDirectory,"/")+(new Date).getTime()+Math.floor(150*Math.random())+".png",aliyunServerURL:r.aliConfig.url,accessid:r.aliConfig.OSSAccessKeyId,url:r.aliConfig.url||"",oos:r.aliConfig.oos||!1},l=c.aliyunFileKey?c.aliyunFileKey:"",p=c.aliyunServerURL?c.aliyunServerURL:"",g=c.accessid?c.accessid:"",_=f(),h=d(n,_),t.next=8,e.uploadFile({url:c.url,filePath:a[o]["path"],name:"file",formData:{key:l,policy:_,OSSAccessKeyId:g,signature:h,success_action_status:"200"},success:function(){var t=s(i.default.mark(function t(r){var s;return i.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(200!=r.statusCode){t.next=10;break}return s=p+l,console.log(u("%c 阿里云上传(成功返回地址):".concat(s),"color:#1AAD19"," at components\\sunui-upimg\\sunui-upimg-alioos.vue:136")),a[o]["path_server"]=s,n.upload_picture_list=a,t.next=7,n.$emit("onUpImg",n.upload_picture_list);case 7:e.hideLoading(),t.next=16;break;case 10:e.showLoading({title:"上传失败!"}),console.log(u("阿里云上传图片失败,返回状态码:",r.statusCode," at components\\sunui-upimg\\sunui-upimg-alioos.vue:146")),setTimeout(function(){e.hideLoading()},2e3),n.upload_picture_list=[],n.upload_after_list=[],console.warn(u("阿里云上传图片失败,返回状态码:",r.statusCode," at components\\sunui-upimg\\sunui-upimg-alioos.vue:152"));case 16:case"end":return t.stop()}},t,this)}));function r(e){return t.apply(this,arguments)}return r}(),fail:function(){var t=s(i.default.mark(function t(n){return i.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e.showLoading({title:"上传失败!"}),setTimeout(function(){e.hideLoading()},2e3),console.log(u(n," at components\\sunui-upimg\\sunui-upimg-alioos.vue:162"));case 3:case"end":return t.stop()}},t,this)}));function n(e){return t.apply(this,arguments)}return n}()});case 8:m=t.sent,m.onProgressUpdate(function(){var e=s(i.default.mark(function e(t){var u,r;return i.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:u=0,r=n.upload_picture_list.length;case 1:if(!(u<r)){e.next=8;break}return e.next=4,t.progress;case 4:a[u]["upload_percent"]=e.sent;case 5:u++,e.next=1;break;case 8:n.upload_picture_list=a;case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}());case 10:case"end":return t.stop()}},t,this)}));return function(e,n,u,i){return t.apply(this,arguments)}}(),_=function(){var e=s(i.default.mark(function e(t,n){var u,r;return i.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:u=0,r=t.upload_picture_list.length;case 1:if(!(u<r)){e.next=8;break}if(0!=t.upload_picture_list[u]["upload_percent"]){e.next=5;break}return e.next=5,g(t,n,t.upload_picture_list,u);case 5:u++,e.next=1;break;case 8:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),h=function(){var e=s(i.default.mark(function e(t,n){return i.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n.$emit("onImgDel",{url:t.currentTarget.dataset.url,index:t.currentTarget.dataset.index});case 2:n.upload_picture_list.splice(t.currentTarget.dataset.index,1),n.upload_after_list.splice(t.currentTarget.dataset.index,1),n.upload_picture_list=n.upload_picture_list;case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),m=function(t,n,u){var r={aliConfig:{AccessKeySecret:u.aliConfig.AccessKeySecret,OSSAccessKeyId:u.aliConfig.OSSAccessKeyId,oosDirectory:u.aliConfig.oosDirectory,url:u.aliConfig.url},count:n,tips:u.tips||!1,notli:u.notli,sourceType:u.sourceType,sizeType:u.sizeType};e.chooseImage({count:r.notli?r.count=9:0==t.upload_after_list.length?r.count:r.count-t.upload_after_list.length,sizeType:""==r.sizeType||void 0==r.sizeType||1==r.sizeType?["compressed"]:["original"],sourceType:""==r.sourceType||void 0==r.sourceType?["album","camera"]:"camera"==r.sourceType?["camera"]:"album"==r.sourceType?["album"]:["album","camera"],success:function(){var e=s(i.default.mark(function e(n){var u,a;return i.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:for(u=0,a=n.tempFiles.length;u<a;u++)n.tempFiles[u]["upload_percent"]=0,n.tempFiles[u]["path_server"]="",t.upload_picture_list.push(n.tempFiles[u]),t.upload_picture_list.length>r.count&&(t.upload_picture_list=t.upload_picture_list.slice(0,r.count));return e.next=3,v(t,n,r);case 3:case"end":return e.stop()}},e,this)}));function n(t){return e.apply(this,arguments)}return n}()})},v=function(e,t,n){!n.notli&&n.count==e.upload_picture_list.length&&_(e,n),n.notli&&9==n.count&&_(e,n),e.upload_after_list=e.upload_after_list.concat(t.tempFilePaths).slice(0,n.count),e.upload_picture_list=e.upload_picture_list.slice(0,n.count)},y=function(t,n){e.previewImage({current:n.upload_after_list[t.currentTarget.dataset.index],urls:n.upload_after_list})},w=function(){var t=s(i.default.mark(function t(n,u){var r,a,s;return i.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:for(r=[],a=0,s=u.upload_picture_list.length;a<s;a++)r.push(u.upload_picture_list[a].path);e.previewImage({current:r[n.currentTarget.dataset.idx],urls:r});case 3:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()}).call(this,n("6e42")["default"],n("0de9")["default"])},"84b1":function(e,t,n){"use strict";var u=n("bf39"),i=n.n(u);i.a},a620:function(e,t,n){"use strict";var u=function(){var e=this,t=e.$createElement;e._self._c},i=[];n.d(t,"a",function(){return u}),n.d(t,"b",function(){return i})},b0b0:function(e,t,n){"use strict";n.r(t);var u=n("0d9b"),i=n.n(u);for(var r in u)"default"!==r&&function(e){n.d(t,e,function(){return u[e]})}(r);t["default"]=i.a},bf39:function(e,t,n){},deb6:function(e,t,n){"use strict";n.r(t);var u=n("a620"),i=n("b0b0");for(var r in i)"default"!==r&&function(e){n.d(t,e,function(){return i[e]})}(r);n("84b1");var a=n("2877"),s=Object(a["a"])(i["default"],u["a"],u["b"],!1,null,"2c7d73f8",null);t["default"]=s.exports}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/sunui-upimg/sunui-upimg-alioos-create-component',
    {
        'components/sunui-upimg/sunui-upimg-alioos-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('6e42')['createComponent'](__webpack_require__("deb6"))
        })
    },
    [['components/sunui-upimg/sunui-upimg-alioos-create-component']]
]);
