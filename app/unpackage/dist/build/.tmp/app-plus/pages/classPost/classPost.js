(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/classPost/classPost"],{5140:function(t,s,o){"use strict";(function(t){o("7e16"),o("921b");e(o("66fd"));var s=e(o("c72b"));function e(t){return t&&t.__esModule?t:{default:t}}t(s.default)}).call(this,o("6e42")["createPage"])},"6a2d":function(t,s,o){"use strict";o.r(s);var e=o("d1bc"),n=o.n(e);for(var a in e)"default"!==a&&function(t){o.d(s,t,function(){return e[t]})}(a);s["default"]=n.a},"9c8a":function(t,s,o){"use strict";var e=function(){var t=this,s=t.$createElement;t._self._c},n=[];o.d(s,"a",function(){return e}),o.d(s,"b",function(){return n})},b4bd:function(t,s,o){},c62f:function(t,s,o){"use strict";var e=o("b4bd"),n=o.n(e);n.a},c72b:function(t,s,o){"use strict";o.r(s);var e=o("9c8a"),n=o("6a2d");for(var a in n)"default"!==a&&function(t){o.d(s,t,function(){return n[t]})}(a);o("c62f");var i=o("2877"),c=Object(i["a"])(n["default"],e["a"],e["b"],!1,null,null,null);s["default"]=c.exports},d1bc:function(t,s,o){"use strict";(function(t,e){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var n=a(o("26f4"));function a(t){return t&&t.__esModule?t:{default:t}}var i=function(){return o.e("components/uni-load-more").then(o.bind(null,"caa8"))},c={components:{uniLoadMore:i},data:function(){return{TabCur:0,postList:[],hotpost:[],status:"loading",Dindex:[],showAppFenxiang:!1,type:"new",page:1,classinfo:[],statusTypes:[{value:"more",text:"加载前",checked:!0},{value:"loading",text:"加载中",checked:!1},{value:"noMore",text:"我是有底线的",checked:!1}],contentText:{contentdown:"查看更多",contentrefresh:"加载中",contentnomore:"我是有底线的"}}},onLoad:function(t){this.classId=t.id,this.getClassInfo(this.classId),this.getPostList(this.classId)},methods:{appFenxiang:function(s,o){switch(s){case 0:this.showAppFenxiang=!1;break;case 1:t.setClipboardData({data:"http://share.angeli.top/?postId="+this.postid,success:function(){console.log(e("success"," at pages\\classPost\\classPost.vue:133"))}}),console.log(e("复制链接"," at pages\\classPost\\classPost.vue:136"));break;case 2:console.log(e(this.Dindex.PictureId[0]," at pages\\classPost\\classPost.vue:139")),console.log(e(this.Dindex.Content," at pages\\classPost\\classPost.vue:140")),console.log(e("http://share.angeli.top/?postId="+this.Dindex.PostsId," at pages\\classPost\\classPost.vue:141")),t.share({provider:"weixin",scene:"WXSceneSession",type:5,imageUrl:this.Dindex.PictureId[0],title:this.Dindex.Content,miniProgram:{id:"gh_a38adc10b952",path:"pages/postinfo/postinfo?id="+this.Dindex.PostsId,type:0,webUrl:"http://share.angeli.top/?postId="+this.Dindex.PostsId},success:function(t){console.log(e(JSON.stringify(t)," at pages\\classPost\\classPost.vue:155"))},fail:function(t){console.log(e("fail:"+JSON.stringify(t)," at pages\\classPost\\classPost.vue:158"))}});break;case 3:t.share({provider:"weixin",scene:"WXSenceTimeline",type:0,href:"http://share.angeli.top/?postId="+this.Dindex.PostsId,title:this.Dindex.Content,summary:this.Dindex.Content,imageUrl:this.Dindex.PictureId[0],success:function(t){console.log(e("success:"+JSON.stringify(t)," at pages\\classPost\\classPost.vue:172"))},fail:function(t){console.log(e("fail:"+JSON.stringify(t)," at pages\\classPost\\classPost.vue:175"))}});break;case 4:t.share({provider:"qq",type:1,href:"http://share.angeli.top/?postId="+this.Dindex.PostsId,summary:this.Dindex.Content,title:this.Dindex.Content,imageUrl:this.Dindex.PictureId[0],success:function(t){console.log(e("success:"+JSON.stringify(t)," at pages\\classPost\\classPost.vue:188"))},fail:function(t){console.log(e("fail:"+JSON.stringify(t)," at pages\\classPost\\classPost.vue:191"))}});break;default:}},getPushPost:function(){""==n.default.userinfo.Auid||null==n.default.userinfo.Auid?(t.showToast({title:"你还没有登录，请登录后再来吧",position:"bottom",icon:"none"}),setTimeout(function(){t.navigateTo({url:"../reg/reg"})},1200)):(n.default.postClass=this.classinfo,t.navigateTo({url:"../post/post"}))},getClassInfo:function(s){var o=this;t.request({method:"GET",url:"https://api.angeli.top/post.php?type=getClassInfo",data:{classId:s,token:n.default.token},header:{"content-type":"application/x-www-form-urlencoded"},success:function(s){t.hideLoading(),o.classinfo=[],o.classinfo=s.data.data,console.log(e(o.classinfo," at pages\\classPost\\classPost.vue:233")),o.weikong=!1,"1"!==s.data.code&&t.showToast({title:"获取话题信息失败",position:"bottom",icon:"none"}),o.$forceUpdate()}})},getpostinfo:function(s){t.navigateTo({url:"../postinfo/postinfo?id="+s})},getbieren:function(s){s==n.default.userinfo.Auid?t.navigateTo({url:"../i/i"}):t.navigateTo({url:"../i/bieren?auid="+s})},getPostList:function(s){var o=this;t.showLoading({title:"获取数据中"}),t.request({method:"GET",url:"https://api.angeli.top/post.php?type=getClassPostList",data:{page:1,count:20,classId:s,postType:this.type,token:n.default.token},header:{"content-type":"application/x-www-form-urlencoded"},success:function(s){t.hideLoading(),o.postList=[],console.log(e("————————————帖子列表——————————"," at pages\\classPost\\classPost.vue:282")),"new"==o.type?o.postList=s.data.data:o.hotpost=s.data.data,console.log(e(o.postList," at pages\\classPost\\classPost.vue:288")),o.weikong=!1,"1"!==s.data.code&&t.showToast({title:"获取帖子失败，建议重启",position:"bottom",icon:"none"}),0==s.data.data&&(o.weikong=!0)},complete:function(){t.hideLoading()}})},showImage:function(s,o){var n=s[o];t.previewImage({current:o,urls:s,longPressActions:{itemList:["保存图片"],success:function(s){t.downloadFile({url:n,success:function(s){console.log(e(s," at pages\\classPost\\classPost.vue:320")),200===s.statusCode?t.saveImageToPhotosAlbum({filePath:s.tempFilePath,success:function(){t.showToast({title:"已保存",position:"bottom",icon:"none"})}}):t.showToast({title:"保存失败",position:"bottom",icon:"none"})}})},fail:function(t){console.log(e(t.errMsg," at pages\\classPost\\classPost.vue:344"))}}})},caidan:function(s){console.log(e(s," at pages\\classPost\\classPost.vue:350")),this.Dindex=s,s.AuthorId==n.default.userinfo.Auid?this.menuList=["分享给朋友","举报","删除帖子"]:this.menuList=["分享给朋友","举报"],t.showActionSheet({itemList:this.menuList,success:function(t){switch(t.tapIndex){case 0:this.showAppFenxiang=!0;break;case 1:break;case 2:break;case 3:break;default:}},fail:function(t){console.log(e(t.errMsg," at pages\\classPost\\classPost.vue:379"))}})},EndLoding:function(s){var o=this;this.page++,console.log(e(this.page," at pages\\classPost\\classPost.vue:385")),t.request({method:"GET",url:"https://api.angeli.top/post.php?type=getClassPostList",data:{page:1,count:20,classId:classId,postType:this.type,token:n.default.token},header:{"content-type":"application/x-www-form-urlencoded"},success:function(s){t.hideLoading(),o.postList=[],console.log(e("————————————帖子列表——————————"," at pages\\classPost\\classPost.vue:402")),"new"==o.type?o.postList=s.data.data:o.hotpost=s.data.data,console.log(e(o.postList," at pages\\classPost\\classPost.vue:408")),o.weikong=!1,"1"!==s.data.code&&t.showToast({title:"获取帖子失败，建议重启",position:"bottom",icon:"none"}),0==s.data.data&&(o.weikong=!0)},complete:function(){t.hideLoading()}})},Like:function(s,o,e,a,i){var c=this;if(""==n.default.userinfo.Auid||null==n.default.userinfo.Auid)return t.showToast({title:"你还没有登录，请登录后再来吧",position:"bottom",icon:"none"}),void setTimeout(function(){t.navigateTo({url:"../reg/reg"})},1200);if(o!=n.default.userinfo.Auid){if(!0===e)var l="del";else l="add";t.request({method:"GET",url:"https://api.angeli.top/post.php?type=Like",data:{fuid:o,postid:s,mode:l,token:n.default.token},header:{"content-type":"application/x-www-form-urlencoded",system:n.default.system},success:function(s){"1"==s.data.code?("add"==l?("new"==c.type?(c.postList[a].ZhongcaoCount=Number(i)+1,c.postList[a].Give=!0):(c.hotpost[a].ZhongcaoCount=Number(i)+1,c.hotpost[a].Give=!0),t.showToast({title:"种草成功！",position:"bottom",icon:"none"})):("new"==c.type?(c.postList[a].ZhongcaoCount=Number(i)-1,c.postList[a].Give=!1):(c.hotpost[a].ZhongcaoCount=Number(i)-1,c.hotpost[a].Give=!1),t.showToast({title:"取消种草成功！",position:"bottom",icon:"none"})),c.$forceUpdate()):t.showToast({title:"种草失败！",position:"bottom",icon:"none"})},complete:function(){}})}else t.showToast({title:"不能给自己种草",position:"bottom",icon:"none"})},tabSelect:function(t){this.TabCur=t,this.type=0==t?"new":"hot",this.getPostList(this.classId)}}};s.default=c}).call(this,o("6e42")["default"],o("0de9")["default"])}},[["5140","common/runtime","common/vendor"]]]);