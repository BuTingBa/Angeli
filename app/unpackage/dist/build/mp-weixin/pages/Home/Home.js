(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/Home/Home"],{"7e16":function(o,t,e){"use strict";e.r(t);var n=e("fc89"),i=e.n(n);for(var a in n)"default"!==a&&function(o){e.d(t,o,function(){return n[o]})}(a);t["default"]=i.a},ade8:function(o,t,e){"use strict";var n=function(){var o=this,t=o.$createElement;o._self._c},i=[];e.d(t,"a",function(){return n}),e.d(t,"b",function(){return i})},d374:function(o,t,e){"use strict";e.r(t);var n=e("ade8"),i=e("7e16");for(var a in i)"default"!==a&&function(o){e.d(t,o,function(){return i[o]})}(a);e("e536");var s=e("2877"),u=Object(s["a"])(i["default"],n["a"],n["b"],!1,null,null,null);t["default"]=u.exports},e536:function(o,t,e){"use strict";var n=e("f9c0"),i=e.n(n);i.a},f9c0:function(o,t,e){},fc89:function(o,t,e){"use strict";(function(o){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(e("9ca3"));function i(o){return o&&o.__esModule?o:{default:o}}function a(o,t,e){return t in o?Object.defineProperty(o,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):o[t]=e,o}var s=function(){return e.e("components/uni-load-more").then(e.bind(null,"9b93"))},u={components:{uniLoadMore:s},data:function(){return{Dindex:[],CustomBar:this.CustomBar,modalName:null,AvatarUrl:"",TabCur:0,gaodu:0,weikong:!0,username:"游客",page:1,postList:[],scrollTop:0,old:{scrollTop:0},status:"loading",statusTypes:[{value:"more",text:"加载前",checked:!0},{value:"loading",text:"加载中",checked:!1},{value:"noMore",text:"我是有底线的",checked:!1}],contentText:{contentdown:"查看更多",contentrefresh:"加载中",contentnomore:"我是有底线的"},zhongcao:"0",guanzhu:"0",userid:"0",fensi:"0",dengji:"0",index:!1}},onLoad:function(t){var e=this;1==t.id&&(console.log(t),this.index=!0),""!=n.default.userinfo.Auid&&null!=n.default.userinfo.Auid||(o.login({provider:"weixin",success:function(t){console.log(t),o.request({method:"POST",url:"https://api.angeli.top/reg.php?type=wxlogin",data:{code:t.code},header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){console.log(t),"0"==t.data.code?(n.default.usersk=t.data.data.session_key,o.showToast({title:"欢迎你，游客",position:"bottom",icon:"none"}),e.AvatarUrl="https://sz.oss.data.angeli.top/angeli-image/1562320238188110.png"):"1"==t.data.code&&(e.AvatarUrl=t.data.data.AvatarUrl,e.username=t.data.data.UserName,e.zhongcao=t.data.data.ZhongcaoCount,e.guanzhu=t.data.data.FollowedCount,e.fensi=t.data.data.FollowerCount,e.dengji=t.data.data.Rank,e.userid=t.data.data.Auid,n.default.userinfo=t.data.data,n.default.cookie=t.header["Set-Cookie"],o.showToast({title:"欢迎你，"+e.username,position:"bottom"}),e.getPostData("new",0)),console.log("———————————用户信息——————————")},fail:function(t){o.showToast({title:"未知原因，登录失败！",position:"bottom",icon:"none"})}}),console.log("请求体结束")},fail:function(t){o.showToast({title:"登录失败呢！关闭之后重新打开吧！",position:"bottom"}),console.error("授权登录失败："+JSON.stringify(t))}}),console.log("测试！：4",this.username)),console.log("测试！：5",this.username)},onReady:function(){console.log("测试！：",this.username),console.log("____________________"),this.getHei(),this.postList=[]},methods:{getFriend:function(){o.navigateTo({url:"../menu/friend"})},getbieren:function(t){o.navigateTo({url:"../i/bieren?auid="+t})},getShoucang:function(){o.navigateTo({url:"../menu/shoucang"})},getJifen:function(){o.navigateTo({url:"../menu/jifen"})},getMessage:function(){o.navigateTo({url:"../menu/Message"})},set:function(){o.navigateTo({url:"../set/set"})},logout:function(){o.clearStorage(),o.showToast(a({title:"已退出登录",position:"bottom",icon:"none"},"position","center")),n.default.userinfo=[],n.default.cookie="",this.modalName=null},cs:function(o){this.old.scrollTop=o.detail.scrollTop},sousuo:function(){o.navigateTo({url:"../sousuo/sousuo"})},getClass:function(t){o.navigateTo({url:"../classPost/classPost?id="+t})},showModal:function(o){this.modalName=o.currentTarget.dataset.target,this.AvatarUrl=n.default.userinfo.AvatarUrl,this.username=n.default.userinfo.UserName,this.zhongcao=n.default.userinfo.ZhongcaoCount,this.guanzhu=n.default.userinfo.FollowedCount,this.fensi=n.default.userinfo.FollowerCount,this.dengji=n.default.userinfo.Rank,this.userid=n.default.userinfo.Auid,console.log("测试！：",this.username)},hideModal:function(o){this.modalName=null},tabSelect:function(o){this.TabCur=o,this.scrollTop=this.old.scrollTop,this.$nextTick(function(){this.scrollTop=0}),console.log(o),0==o?this.getPostData("new",0):1==o?this.getPostData("hot",0):2==o&&this.getPostData("guanzhu",0)},Like:function(t,e,i,a){var s=this;if(!0===i)var u="del";else u="add";o.request({method:"GET",url:"https://api.angeli.top/post.php?type=Like",data:{fuid:e,postid:t,mode:u},header:{"content-type":"application/x-www-form-urlencoded",Cookie:n.default.cookie},success:function(t){"1"==t.data.code?("add"==u?(s.postList[a].Give=!0,o.showToast({title:"种草成功！",position:"bottom",icon:"none"})):(s.postList[a].Give=!1,o.showToast({title:"取消种草成功！",position:"bottom",icon:"none"})),s.$forceUpdate()):o.showToast({title:"种草失败！",position:"bottom",icon:"none"})},complete:function(){}})},caidan:function(t){console.log(t),this.Dindex=t,o.showActionSheet({itemList:["分享给朋友","生成海报","举报"],success:function(t){0==t.tapIndex&&o.showToast({title:"分享"+t.Content,position:"bottom",icon:"none"})},fail:function(o){console.log(o.errMsg)}})},getHei:function(){var t=this,e=o.createSelectorQuery().select("#topbox");e.fields({size:!0,scrollOffset:!0},function(o){t.gaodu=o.height-5,console.log("总高度："+t.gaodu)}).exec()},showImage:function(t,e){o.previewImage({current:e,urls:t,longPressActions:{itemList:["发送给朋友","保存图片","收藏"],success:function(t){o.showToast({title:"选中了第"+(t.tapIndex+1)+"个按钮",position:"bottom",icon:"none"}),console.log("选中了第"+(t.tapIndex+1)+"个按钮")},fail:function(o){console.log(o.errMsg)}}})},getPostData:function(t,e){var i=this;o.showLoading({title:"获取数据中"}),console.log(t),o.request({method:"GET",url:"https://api.angeli.top/post.php?type=outPostList",data:{page:0,postType:t,count:10,classId:e},header:{"content-type":"application/x-www-form-urlencoded",Cookie:n.default.cookie},success:function(t){o.hideLoading(),i.postList=[],console.log(t.data.data),console.log("————————————帖子列表——————————"),i.postList=t.data.data,console.log(i.postList),i.weikong=!1,"1"!==t.data.code&&o.showToast({title:"获取帖子失败，建议重启",position:"bottom",icon:"none"}),0==t.data.data&&(i.weikong=!0),i.$forceUpdate()},complete:function(){o.hideLoading()}})},reguser:function(){""==n.default.userinfo.Auid||null==n.default.userinfo.Auid?o.navigateTo({url:"../reg/reg"}):o.navigateTo({url:"../i/i"})},getVip:function(){o.navigateTo({url:"../vip/vip"})},pluspost:function(){console.log("发帖：",n.default.userinfo.Auid),""==n.default.userinfo.Auid||null==n.default.userinfo.Auid?(o.showToast({title:"你还没有登录，请登录后再来吧",position:"bottom",icon:"none"}),setTimeout(function(){o.navigateTo({url:"../reg/reg"})},1200)):o.navigateTo({url:"../post/post"})},EndLoding:function(t){var e=this;this.page++,console.log(this.scrollTop),o.request({method:"GET",url:"https://api.angeli.top/post.php?type=outPostList",data:{page:this.page,posttype:"1",sort:"PsotDate",count:10},header:{"content-type":"application/x-www-form-urlencoded",Cookie:n.default.cookie},success:function(o){console.log("————————————帖子列表——————————"+e.page),void 0==o.data.data.length?(e.page--,e.status="noMore"):(e.postList=e.postList.concat(o.data.data),e.status="loading",console.log(e.postList))}})},getpostinfo:function(t){o.navigateTo({url:"../postinfo/postinfo?id="+t})}},onShareAppMessage:function(o){return"button"===o.from&&console.log(o.target),{title:this.postInfo.Content,path:"/pages/postinfo/postinfo?id="+this.postid,desc:this.postInfo.Content,imageUrl:this.postInfo.PictureId[0]}}};t.default=u}).call(this,e("543d")["default"])}},[["670f","common/runtime","common/vendor"]]]);